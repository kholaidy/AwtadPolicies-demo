!function(){'use strict';const e=document.currentScript,t={endpoint:e?.dataset.endpoint||window.AWTAD_AI_ENDPOINT||'https://awtad-policies-ai.kholaidy.workers.dev/api/policies-ai',title:e?.dataset.title||'ü§ñ ŸÖÿ≥ÿßÿπÿØ ÿßŸÑÿ≥Ÿäÿßÿ≥ÿßÿ™ ÿßŸÑÿ∞ŸÉŸä',welcomeMessage:e?.dataset.welcome||'ÿ£ŸÑÿµŸÇ ŸÜÿµ ÿßŸÑÿ≥Ÿäÿßÿ≥ÿ© ŸáŸÜÿß‚Ä¶ ÿ£Ÿà ÿßÿ™ÿ±ŸÉŸÜŸä ÿ£ŸÇÿ±ÿ£ ÿßŸÑÿµŸÅÿ≠ÿ©.',lang:e?.dataset.lang||'ar',maxTextLength:14e3,maxPageReadLength:12e3,localStorageKey:'awtad_ai_buffer'};let o=!1,n;function i(){const e=document.createElement('style');e.textContent=`
            :root {
                --awtad-ai-primary: #007bff;
                --awtad-ai-primary-hover: #0056b3;
                --awtad-ai-bg: #fff;
                --awtad-ai-text: #212529;
                --awtad-ai-border: #dee2e6;
                --awtad-ai-header-bg: #f8f9fa;
                --awtad-ai-shadow: 0 .5rem 1rem rgba(0,0,0,.15);
                --awtad-ai-btn-secondary-bg: #6c757d;
                --awtad-ai-btn-secondary-hover: #5a6268;
                --awtad-ai-error: #dc3545;
                --awtad-ai-success: #28a745;
            }
            @media (prefers-color-scheme: dark) {
                :root {
                    --awtad-ai-primary: #0d6efd;
                    --awtad-ai-primary-hover: #0b5ed7;
                    --awtad-ai-bg: #212529;
                    --awtad-ai-text: #f8f9fa;
                    --awtad-ai-border: #495057;
                    --awtad-ai-header-bg: #343a40;
                    --awtad-ai-shadow: 0 .5rem 1rem rgba(255,255,255,.05);
                    --awtad-ai-btn-secondary-bg: #495057;
                    --awtad-ai-btn-secondary-hover: #5c636a;
                }
            }
            .awtad-ai-widget-button {
                cursor: pointer;
                padding: 5px 10px;
                border: 1px solid var(--awtad-ai-primary);
                background-color: transparent;
                color: var(--awtad-ai-primary);
                border-radius: 5px;
                font-size: 14px;
                margin: 0 5px;
                transition: all 0.2s ease-in-out;
            }
            .awtad-ai-widget-button:hover {
                background-color: var(--awtad-ai-primary);
                color: var(--awtad-ai-bg);
            }
            .awtad-ai-modal-overlay {
                position: fixed; z-index: 9998; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); display: flex; justify-content: center; align-items: center;
            }
            .awtad-ai-modal {
                direction: rtl; position: fixed; z-index: 9999; background: var(--awtad-ai-bg); color: var(--awtad-ai-text); border-radius: 8px; box-shadow: var(--awtad-ai-shadow); width: 90%; max-width: 600px; display: flex; flex-direction: column; top: 50%; left: 50%; transform: translate(-50%, -50%);
            }
            .awtad-ai-modal-header {
                padding: 10px 15px; background: var(--awtad-ai-header-bg); border-bottom: 1px solid var(--awtad-ai-border); cursor: move; border-top-left-radius: 8px; border-top-right-radius: 8px; display: flex; justify-content: space-between; align-items: center;
            }
            .awtad-ai-modal-body {
                padding: 15px; flex-grow: 1; display: flex; flex-direction: column; gap: 10px;
            }
            .awtad-ai-modal-textarea {
                width: 100%; height: 150px; padding: 10px; border: 1px solid var(--awtad-ai-border); border-radius: 5px; background: var(--awtad-ai-bg); color: var(--awtad-ai-text); resize: vertical;
            }
            .awtad-ai-modal-result {
                flex-grow: 1; border: 1px solid var(--awtad-ai-border); border-radius: 5px; padding: 10px; min-height: 100px; overflow-y: auto; background-color: var(--awtad-ai-header-bg);
            }
            .awtad-ai-modal-footer {
                padding: 10px 15px; border-top: 1px solid var(--awtad-ai-border); display: flex; flex-wrap: wrap; gap: 5px; justify-content: flex-start;
            }
            .awtad-ai-modal-btn {
                cursor: pointer; padding: 8px 12px; border-radius: 5px; border: none; font-size: 14px; transition: background-color 0.2s;
            }
            .awtad-ai-btn-action { background-color: var(--awtad-ai-primary); color: white; }
            .awtad-ai-btn-action:hover:not(:disabled) { background-color: var(--awtad-ai-primary-hover); }
            .awtad-ai-btn-action:disabled { opacity: 0.6; cursor: not-allowed; }
            .awtad-ai-btn-secondary { background-color: var(--awtad-ai-btn-secondary-bg); color: white; }
            .awtad-ai-btn-secondary:hover { background-color: var(--awtad-ai-btn-secondary-hover); }
            .awtad-ai-status {
                font-size: 12px; margin-top: 5px; text-align: center;
            }
            .awtad-ai-status.error { color: var(--awtad-ai-error); }
            .awtad-ai-status.loading::after {
                content: '...';
                display: inline-block;
                animation: awtad-ai-ellipsis 1.2s infinite;
            }
            @keyframes awtad-ai-ellipsis { 0%, 20% { content: '.'; } 40% { content: '..'; } 60%, 100% { content: '...'; } }
        `,document.head.appendChild(e)}function a(){const e=document.createElement('div');e.className='awtad-ai-modal-overlay',e.style.display='none';const i=document.createElement('div');return i.className='awtad-ai-modal',i.innerHTML=`
            <div class="awtad-ai-modal-header">
                <span>${t.title}</span>
                <button class="awtad-ai-modal-btn awtad-ai-btn-secondary" data-action="close">&times;</button>
            </div>
            <div class="awtad-ai-modal-body">
                <textarea class="awtad-ai-modal-textarea" placeholder="${t.welcomeMessage}"></textarea>
                <div class="awtad-ai-modal-result" aria-live="polite"></div>
                <div class="awtad-ai-status"></div>
            </div>
            <div class="awtad-ai-modal-footer">
                <button class="awtad-ai-modal-btn awtad-ai-btn-action" data-action="improve">ÿ≠ÿ≥ŸëŸÜ ÿßŸÑÿ≥Ÿäÿßÿ≥ÿ©</button>
                <button class="awtad-ai-modal-btn awtad-ai-btn-action" data-action="compliance">ŸÅÿ≠ÿµ ÿßŸÑÿßŸÑÿ™ÿ≤ÿßŸÖ</button>
                <button class="awtad-ai-modal-btn awtad-ai-btn-action" data-action="new">ÿ•ŸÜÿ¥ÿßÿ° ÿ≥Ÿäÿßÿ≥ÿ© ÿ¨ÿØŸäÿØÿ©</button>
                <button class="awtad-ai-modal-btn awtad-ai-btn-secondary" data-action="copy">ŸÜÿ≥ÿÆ</button>
            </div>
        `,e.appendChild(i),document.body.appendChild(e),i.addEventListener('click',e=>{const t=e.target.dataset.action;if(!t)return;switch(t){case'close':modalOverlay.style.display='none';break;case'copy':navigator.clipboard.writeText(resultArea.innerText).then(()=>{statusArea.textContent='ÿ™ŸÖ ÿßŸÑŸÜÿ≥ÿÆ!',setTimeout(()=>{statusArea.textContent=''},2e3)});break;case'improve':case'compliance':case'new':d(t)}}),r(i),e}function d(e){if(o)return;let i=textarea.value.trim();if(!i){const e=document.querySelector('main')?.innerText||document.body.innerText;i=e.substring(0,t.maxPageReadLength)}if(!i)return statusArea.textContent='ŸÑŸÖ Ÿäÿ™ŸÖ ÿßŸÑÿπÿ´Ÿàÿ± ÿπŸÑŸâ ŸÜÿµ ŸÑŸÑŸÖÿπÿßŸÑÿ¨ÿ©.',void(statusArea.className='awtad-ai-status error');o=!0;const n=modal.querySelectorAll('.awtad-ai-btn-action');n.forEach(e=>e.disabled=!0),statusArea.textContent='ÿ¨ÿßÿ±Ÿä ÿßŸÑŸÖÿπÿßŸÑÿ¨ÿ©...',statusArea.className='awtad-ai-status loading',resultArea.innerHTML='',fetch(t.endpoint,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({text:i.substring(0,t.maxTextLength),page:location.pathname,action:e})}).then(e=>{if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);return e.json()}).then(e=>{resultArea.innerHTML=e.result.replace(/\n/g,'<br>'),statusArea.textContent=''}).catch(e=>{console.error('Awtad AI Widget Error:',e),statusArea.textContent='ÿ≠ÿØÿ´ ÿÆÿ∑ÿ£. ŸÇÿØ ÿ™ŸÉŸàŸÜ ŸáŸÜÿßŸÉ ŸÖÿ¥ŸÉŸÑÿ© ŸÅŸä ÿßŸÑÿ¥ÿ®ŸÉÿ© ÿ£Ÿà CORS. (ÿßŸÜÿ∏ÿ± ÿßŸÑŸÉŸàŸÜÿ≥ŸàŸÑ)',statusArea.className='awtad-ai-status error'}).finally(()=>{o=!1,n.forEach(e=>e.disabled=!1),statusArea.classList.contains('loading')&&(statusArea.textContent='')})}function r(e){let t,o,n,i;const a=e.querySelector('.awtad-ai-modal-header');function d(e){(e=e||window.event).preventDefault(),n=e.clientX,i=e.clientY,document.onmouseup=l,document.onmousemove=c}function c(a){(a=a||window.event).preventDefault(),t=n-a.clientX,o=i-a.clientY,n=a.clientX,i=a.clientY,e.style.top=e.offsetTop-o+'px',e.style.left=e.offsetLeft-t+'px'}function l(){document.onmouseup=null,document.onmousemove=null}a?a.onmousedown=d:e.onmousedown=d}function c(){const e=['button:contains("ÿ∑ÿ®ÿßÿπÿ©")','a:contains("ÿ∑ÿ®ÿßÿπÿ©")','button:contains("Print")','a:contains("Print")','[onclick*="print"]'],t=['header','.topbar','body'];let o=null;for(const n of e)try{if(n.includes(':contains')){const[e,t]=n.split(':contains'),i=t.replace(/['"]/g,'').slice(1,-1);document.querySelectorAll(e).forEach(e=>{e.textContent.includes(i)&&(o=e)})}else o=document.querySelector(n);if(o)break}catch(e){}const i=document.createElement('button');if(i.className='awtad-ai-widget-button',i.innerHTML='ü§ñ ŸÖÿ≥ÿßÿπÿØ ÿßŸÑÿ≥Ÿäÿßÿ≥ÿßÿ™',i.onclick=()=>{const e=document.querySelector('.awtad-ai-modal-overlay');e&&(e.style.display='flex')},o)return o.parentNode.insertBefore(i,o.nextSibling),!0;for(const e of t){const t=document.querySelector(e);if(t)return t.appendChild(i),!0}return!1}function l(){if(i(),a(),c())return;const e=new MutationObserver((e,t)=>{c()&&t.disconnect()});e.observe(document.body,{childList:!0,subtree:!0})}'loading'===document.readyState?document.addEventListener('DOMContentLoaded',l):l()}();